## General Topics ##
--------------------

#### Hierarchical Overriding Config ####
When the O2System\Core\URI sends segments tobe parsed by O2System\Core\Router. The Router will automatically checked
if there is an app or module requested by the URI segments, then the Router will told O2System\Core\Config to reload
the config by requested segments

**Example:**
``http://example.com/app``
> App is a key name off a single app inside applications, this is the step:

1. applications/config/config.php (first loading)
2. applications/app/config/config.php (second loading - will override the config if the new value of replacement config is defined)

> Same behaviour if module or module inside an app if requested at URI segments

#### Hierarchical Overriding Views ####
> Applications Views, Application View, Module View can be replaced by created same view name under apps, app, module or themes module views. Example:
```
applications/views/error_404.tpl
---- applications/views/error_404.tpl
------- applications/modules/module_name/views/error_404.tpl
---------- applications/themes/theme_name/modules/module_name/error_404.tpl
```

### Folder Structure ###
------------------------

#### Single Application Example ####

```
applications
-- core
-- helpers
-- libraries
-- languages
-- models
-- views
-- controllers
-- modules
----- your_module_name
------ helpers
------ libraries
------ languages
------ models
------ views
------ controllers
system
-- core
-- helpers
-- libraries
-- languages
-- models
-- views
-- controllers
-- vendor
.htaccess
index.php
```

#### Multi Applications Example ####

```
applications
-- core
-- helpers
-- libraries
-- languages
-- models
-- views
-- controllers
-- your_app
---- core
---- helpers
---- libraries
---- languages
---- models
---- views
---- controllers
---- modules
----- your_module_name
------ helpers
------ libraries
------ languages
------ models
------ views
------ controllers
system
-- core
-- helpers
-- libraries
-- languages
-- models
-- views
-- controllers
-- vendor
.htaccess
index.php
```
> The folder structure at each app and each module under app is same folder structure with system folder, you can add the folder based on your needs.

### System Folder ###
- Caching folder
  By default cache folder is located at:
  ``applications/cache/``

### URL Design Pattern ##
By default, URLs in O2System are designed to be search-engine and human friendly. Rather than using the standard “query string” approach to URLs that is synonymous with dynamic systems, O2System uses a segment-based approach:
`` example.com/articles/view/123-article-title ``

O2System has a lot of URI Segments Pattern. The segments in the URL, in following with the Hierarchical-Model-View-Controller approach.

#### Applications Access ####
``example.com/method/parameters``
1. represents the default controller class function, or method, that should be called.
2. represents parameters to be passed into the called controller method.

#### Applications Controller Access ####
``example.com/controller/method/params``
1. represents the controller class that should be invoked.
2. represents the controller class function, or method, that should be called.
3. represents parameters to be passed into the called controller method.

#### Applications Module Access ####
``example.com/module/method/params``
1. represents the applications module to be loaded
2. represents the controller (default controller) class function, or method, that should be called.
3. represents parameters to be passed into the called controller method.

#### Applications Module Controller Access ####
``example.com/module/controller/method/params``
1. represents the applications module to be loaded
2. represents the module controller class that should be invoked.
3. represents the class function, or method, that should be called.
4. represents parameters to be passed into the called controller method.

#### App Access ####
``example.com/app/method/params``
1. represents the app to be loaded
2. represents the controller (default controller) class function, or method, that should be called.
3. represents parameters to be passed into the called controller method.

#### App Controller Access ####
``example.com/app/controller/method/params``
1. represents the app to be loaded
2. represents the app controller class that should be invoked.
3. represents the class function, or method, that should be called.
4. represents parameters to be passed into the called controller method.

#### App Module Access ####
``example.com/app/module/method/params``
1. represents the app to be loaded
2. represents the module to be loaded
3. represents the controller (default controller) class function, or method, that should be called.
4. represents parameters to be passed into the called controller method.

#### App Module Controller Access ####
``example.com/app/module/controller/method/params``
1. represents the app to be loaded
2. represents the module to be loaded
3. represents the app controller class that should be invoked.
4. represents the class function, or method, that should be called.
5. represents parameters to be passed into the called controller method.

> **Note: ** 
The URI Library and the URL Helper contain functions that make it easy to work with your URI data. In addition, your URLs can be remapped using the URI Routing feature for more flexibility.

#### Removing the index.php file ####
By default, the index.php file will be included in your URLs:

``example.com/index.php/articles/view/123-article-title``

If your Apache server has mod_rewrite enabled, you can easily remove this file by using a .htaccess file with some simple rules. Here is an example of such a file, using the “negative” method in which everything is redirected except the specified items:
```htaccess
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L]
```
In the above example, any HTTP request other than those for existing directories and existing files is treated as a request for your index.php file.

> **Note**
These specific rules might not work for all server configurations.

> **Note**
Make sure to also exclude from the above rule any assets that you might need to be accessible from the outside world.

#### Adding a URL Suffix ####
In your config/config.php file you can specify a suffix that will be added to all URLs generated by O2System. For example, if a URL is this:

``example.com/articles/view/123-article-title``

You can optionally add a suffix, like .html, making the page appear to be of a certain type:

``example.com/articles/view/123-article-title.html``

### Controllers ###
Controllers are the heart of your application, as they determine how HTTP requests should be handled.

#### What is a Controller? ####
A Controller is simply a class file that is named in a way that can be associated with a URI.

Consider this URI:
``example.com/index.php/articles/``
In the above example, O2System would attempt to find a controller named Articles.php and load it.

When a controller’s name matches of a URI, it will be loaded.

#### Let’s try it: Hello World! ####
Let’s create a simple controller so you can see it in action. Using your text editor, create a file called Articles.php, and put the following code in it:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller
{
    public function index()
    {
        echo 'Hello World!';
    }
}
```
Then save the file to your applications/controllers/ directory.

> **Important**
The file must be called ‘Articles.php’, with a capital ‘A’.

Now visit the your site using a URL similar to this:

``example.com/index.php/articles/``

If you did it right, you should see:
``Hello World!``

> **Important**
Class names must start with an uppercase letter.

This is valid:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller
{

}
```

This is not valid:

```php
<?php
class articles extends \O2System\Controller
{

}
```

> **Important**
1. Make sure namespace is defined in your controller header
2. Make sure your controller extends the parent controller class so that it can inherit all its methods.

#### Methods ####
In the above example the method name is index(). The “index” method is always loaded by default if the second segment of the URI is empty. Another way to show your “Hello World” message would be this:

``example.com/index.php/articles/index/``

The second segment of the URI determines which method in the controller gets called.

Let’s try it. Add a new method to your controller:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller
{
    public function index()
    {
        echo 'Hello World!';
    }

    public function category()
    {
        echo 'This is my articles category!';
    }
}
```

Now load the following URL to see the comment method:

``example.com/index.php/articles/category/``

You should see your new message.

#### Passing URI Segments to your methods ####

If your URI contains more than two segments they will be passed to your method as parameters.

For example, let’s say you have a URI like this:

``example.com/index.php/articles/view/programming/123``

Your method will be passed URI segments 3 and 4 (“programming” and “123”):

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller
{
    public function index()
    {
        echo 'Hello World!';
    }

    public function category()
    {
        echo 'This is my articles category!';
    }

    public function view($category, $id)
    {
        echo $category.'-'.$id;
    }
}
```
> **Important**
If you are using the URI Routing feature, the segments passed to your method will be the re-routed ones.

#### Defining a Default Controller ####
O2System can be told to load a default controller when a URI is not present, as will be the case when only your site root URL is requested. To specify a default controller, open your applications/config/routes.php file and set this variable:

$route['default_controller'] = 'articles';
Where Articles is the name of the controller class you want used. If you now load your main index.php file without specifying any URI segments you’ll see your Hello World message by default.

#### Rerouting Method Calls ####
As noted above, the second segment of the URI typically determines which method in the controller gets called. O2System permits you to override this behavior through the use of the _route() method:

```php
public function _route($method, array $params = array())
{
    // Some code here...
}
```

> Important
If your controller contains a method named _route(), it will always get called regardless of what your URI contains. It overrides the normal behavior in which the URI determines which method is called, allowing you to define your own method routing rules.
The overridden method call (typically the second segment of the URI) will be passed as a parameter to the _route() method:


```php
public function _route($method)
{
    if ($method === 'some_method')
    {
        $this->$method();
    }
    else
    {
        $this->default_method();
    }
}
```
Any extra segments after the method name are passed into _route() as an optional second parameter. This array can be used in combination with PHP’s call_user_func_array() to emulate O2System’s default behavior.

Example:

```php
public function _route($method, $params = array())
{
    $method = 'process_'.$method;
    if (method_exists($this, $method))
    {
        return call_user_func_array(array($this, $method), $params);
    }
    show_404();
}
```

#### Processing Output ####
O2System has an output class that takes care of sending your final rendered data to the web browser automatically. More information on this can be found in the Views and Output Class pages. In some cases, however, you might want to post-process the finalized data in some way and send it to the browser yourself. O2System permits you to add a method named _output() to your controller that will receive the finalized output data.

> **Important**
If your controller contains a method named _output(), it will always be called by the output class instead of echoing the finalized data directly. The first parameter of the method will contain the finalized output.

Here is an example:

```php
public function _output($output)
{
        echo $output;
}
```
> **Note**
Please note that your _output() method will receive the data in its finalized state. Benchmark and memory usage data will be rendered, cache files written (if you have caching enabled), and headers will be sent (if you use that feature) before it is handed off to the _output() method. To have your controller’s output cached properly, its _output() method can use:

```php
if ($this->output->cache_expiration > 0)
{
    $this->output->_write_cache($output);
}
```

If you are using this feature the page execution timer and memory usage stats might not be perfectly accurate since they will not take into account any further processing you do. For an alternate way to control output before any of the final processing is done, please see the available methods in the Output Library.
Private methods
In some cases you may want certain methods hidden from public access. In order to achieve this, simply declare the method as being private or protected and it will not be served via a URL request. For example, if you were to have a method like this:

```php
protected function _utility()
{
    // some code
}
```

Trying to access it via the URL, like this, will not work:

``example.com/index.php/articles/_utility/``

> **Note**
Prefixing method names with an underscore will also prevent them from being called. This is a legacy feature that is left for backwards-compatibility.
Organizing Your Controllers into Sub-directories
If you are building a large application you might find it convenient to organize your controllers into sub-directories. O2System permits you to do this.

Simply create folders within your applications/controllers/ directory and place your controller classes within them.

> **Note**
When using this feature of your URI must specify the folder. For example, let’s say you have a controller located here:

``application/controllers/products/Shoes.php``

To call the above controller your URI will look something like this:

``example.com/index.php/products/shoes/show/123``

Each of your sub-directories may contain a default controller which will be called if the URL contains only the sub-folder. Simply name your default controller as specified in your application/config/routes.php file.

O2System also permits you to remap your URIs using its URI Routing feature.

#### Class Constructors ####
If you intend to use a constructor in any of your Controllers, you MUST place the following line of code in it:

```php
parent::__construct();
```

The reason this line is necessary is because your local constructor will be overriding the one in the parent controller class so we need to manually call it.

> **Important**
By default O2System has disabled the __construct() function and provide __reconstruct() as class constructor.

Example:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller
{
    protected function __construct()
    {
        parent::__construct();
        // Your own constructor code
    }
}
```

Constructors are useful if you need to set some default values, or run a default process when your class is instantiated. Constructors can’t return a value, but they can do some default work.

### Views ###
A view is simply a web page, or a page fragment, like a header, footer, sidebar, etc. In fact, views can flexibly be embedded within other views (within other views, etc., etc.) if you need this type of hierarchy.

Views are never called directly, they must be loaded by a controller. Remember that in an MVC framework, the Controller acts as the traffic cop, so it is responsible for fetching a particular view. If you have not read the Controllers page you should do so before continuing.

Using the example controller you created in the controller page, let’s add a view to it.

#### Creating a View ####
Using your text editor, create a file called articlesview.php, and put this in it:
```php
<html>
    <head>
        <title>My articles</title>
    </head>
    <body>
        <h1>Welcome to my articles!</h1>
    </body>
</html>
```
Then save the file in your applications/views/ directory.

#### Loading a View ####
To load a particular view file you will use the following method:

$this->view->load('name');
Where name is the name of your view file.

> **Note**
The .php file extension does not need to be specified unless you use something other than .php.
Now, open the controller file you made earlier called Articles.php, and replace the echo statement with the view loading method:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller {

        public function index()
        {
                $this->view->load('articlesview');
        }
}
```

If you visit your site using the URL you did earlier you should see your new view. The URL was similar to this:

``
example.com/index.php/articles/
``
#### Loading multiple views ####
CodeIgniter will intelligently handle multiple calls to $this->view->load() from within a controller. If more than one call happens they will be appended together. For example, you may wish to have a header view, a menu view, a content view, and a footer view. That might look something like this:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller {

        public function index()
        {
                $data['page_title'] = 'Your title';
                $this->view->load('header');
                $this->view->load('menu');
                $this->view->load('content', $data);
                $this->view->load('footer');
        }

}
```

In the example above, we are using “dynamically added data”, which you will see below.

#### Storing Views within Sub-directories ####

Your view files can also be stored within sub-directories if you prefer that type of organization. When doing so you will need to include the directory name loading the view. 

> **Example:**

```php
$this->view->load('directory_name/file_name');
```

#### Adding Dynamic Data to the View ####
Data is passed from the controller to the view by way of an array or an object in the second parameter of the view loading method. Here is an example using an array:

```php
$data = array(
        'title' => 'My Title',
        'heading' => 'My Heading',
        'message' => 'My Message'
);

$this->view->load('articlesview', $data);
```

And here’s an example using an object:

```php
$data = new Someclass();
$this->view->load('articlesview', $data);
```

> **Note**
If you use an object, the class variables will be turned into array elements.
Let’s try it with your controller file. Open it add this code:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controller
{
    public function index()
    {
        $data['title'] = 'Article Title';
        $data['heading'] = 'Article Heading';

        $this->view->load('article_view', $data);
    }
}
```

Now open your view file and change the text to variables that correspond to the array keys in your data:

```php
<html>
    <head>
        <title><?php echo $title;?></title>
    </head>
    <body>
        <h1><?php echo $heading;?></h1>
    </body>
</html>
```

Then load the page at the URL you’ve been using and you should see the variables replaced.

#### Creating Loops ####
The data array you pass to your view files is not limited to simple variables. You can pass multi dimensional arrays, which can be looped to generate multiple rows. For example, if you pull data from your database it will typically be in the form of a multi-dimensional array.

Here’s a simple example. Add this to your controller:

```php
<?php
namespace Applications\Controllers;

class Articles extends \O2System\Controllers
{
    public function index()
    {
        $data['author'] = array(
            'full_name' => 'Steeven Andrian',
            'email' => 'steevenz@steevenz.com'
        );

        $data['title'] = 'Open Source PHP Framework'
        $data['heading'] = 'O2System Framework'

        $this->view->load('article_view', $data);
    }
}
```

Now open your view file and create a loop:

```php
<html>
<head>
        <title><?php echo $title; ?></title>
</head>
<body>
        <h1><?php echo $heading; ?></h1>

        <h3>My Todo List</h3>

        <ul>
        <?php foreach( $todo_list as $item ): ?>

                <li><?php echo $item;?></li>

        <?php endforeach; ?>
        </ul>

</body>
</html>
```
> **Note**
You’ll notice that in the example above we are using PHP’s alternative syntax. If you are not familiar with it you can read about it here.
Returning views as data
There is a third optional parameter lets you change the behavior of the method so that it returns data as a string rather than sending it to your browser. This can be useful if you want to process the data in some way. If you set the parameter to TRUE (boolean) it will return data. The default behavior is false, which sends it to your browser. Remember to assign it to a variable if you want the data returned:

```php
$string = $this->view->load('myfile', '', TRUE);
```

#### Let’s try with modularity concept! ####

Consider this URI:
``example.com/index.php/member``
In the above example, O2System would attempt to find a controller named Member.php inside applications/modules/member/controllers/ directory and load it.

Let’s create a simple controller so you can see it in action. Using your text editor, create a file called Member.php, and put the following code in it:

```php
<?php
namespace Member\Controllers;

class Member extends \O2System\Controller
{
    public function index()
    {
        echo 'Welcome to member area!';
    }
}
```
Then save the file to your applications/modules/member/controllers/ directory.

> **Important**
If you have a controller file with the same file name with the name of your module, O2System will ONLY load that controller file when the URI found a mactch segment with your module name.
If you want to use multiple controllers inside your module, you must have a <module>/config/route.php and defined your default controller.

### Reserved method names ###
Since your controller classes will extend the main application controller you must be careful not to name your methods identically to the ones used by that class, otherwise your local functions will override them. See Reserved Names for a full list.

> **Important**
You should also never have a method named identically to its class name. If you do, and there is no __construct() method in the same class, then your e.g. Index::index() method will be executed as a class constructor!

That’s it!
That, in a nutshell, is all there is to know about controllers.
  
### System Registry ###
O2System is collected the map of your folder structure from the the first system is initiated. This is the heart of the system. For example please take a look at system/core/Loader.php. O2System do different way to loading file than CodeIgniter. O2System doesn't loop the paths for searching, because the System Registry has provide the path data. All the loader need to do is validate the requested.
  
### Working with Composer ###
O2System is supported for development using composer autoload. The big different from O2System with CodeIgniter or Laravel is by default O2System has composer autoload on system folder (system/vendor) but you can add custom vendor under your apps folder (apps/vendor) also you can add under each app and each app module.

Others framework load all dependencies that defined on composer.json from the the first system is initiated.
O2System doesn't load all at the same time, depends on your needs. For example if you has add custom vendor at the your app the O2System loader only load all composer vendor from system, apps, and your requested access app (by url or as defined on BASEAPP) same with the module under your app. It's only load when you access the module.

### SPL-Autoloader Loader (PSR-0) ###
O2System can help you to perform load cross app and cross app modules. The syntax is still the same with CodeIgniter the only different is the called path

> Standard Load (cross applications, modules, components, plugins, widgets supported)

```
// loading library
$this->load->library('class_name');

// access library in singleton
$this->class_name->method();

// automatically  loading library (spl_autoload)
$obj = new \O2System\Libraries\Class_Name();

// auto init library
$obj =& \O2System\Libraries\Class_Name::initialize(); // (for libraries using Glob);
```

### Security ###
This page describes some “best practices” regarding web security, and details O2System’s internal security features.

#### URI Security ####
O2System is fairly restrictive regarding which characters it allows in your URI strings in order to help minimize the possibility that malicious data can be passed to your application. URIs may only contain the following:

- Alpha-numeric text (latin characters only)
- Tilde: ~
- Percent sign: %
- Period: .
- Colon: :
- Underscore: _
- Dash: -
- Space

#### Register_globals ####
During system initialization all global variables that are found to exist in the $_GET, $_POST, $_REQUEST and $_COOKIE are unset.

The unsetting routine is effectively the same as register_globals = off.

#### display_errors ####
In production environments, it is typically desirable to “disable” PHP’s error reporting by setting the internal display_errors flag to a value of 0. This disables native PHP errors from being rendered as output, which may potentially contain sensitive information.

Setting O2System’s ENVIRONMENT constant in index.php to a value of ‘production’ will turn off these errors. In development mode, it is recommended that a value of ‘development’ is used. More information about differentiating between environments can be found on the Handling Environments page.

#### magic_quotes_runtime ####
The magic_quotes_runtime directive is turned off during system initialization so that you don’t have to remove slashes when retrieving data from your database.

#### Best Practices ####
Before accepting any data into your application, whether it be POST data from a form submission, COOKIE data, URI data, XML-RPC data, or even data from the SERVER array, you are encouraged to practice this three step approach:

Validate the data to ensure it conforms to the correct type, length, size, etc. (sometimes this step can replace step one)
Filter the data as if it were tainted.
Escape the data before submitting it into your database or outputting it to a browser.
CodeIgniter provides the following functions and tips to assist you in this process:

#### XSS Filtering ####
O2System comes with a Cross Site Scripting filter. This filter looks for commonly used techniques to embed malicious JavaScript into your data, or other types of code that attempt to hijack cookies or do other malicious things. The XSS Filter is described here.

> **Note:**
XSS filtering should only be performed on output. Filtering input data may modify the data in undesirable ways, including stripping special characters from passwords, which reduces security instead of improving it.

#### CSRF protection ####
CSRF stands for Cross-Site Request Forgery, which is the process of an attacker tricking their victim into unknowingly submitting a request.

O2System provides CSRF protection out of the box, which will get automatically triggered for every non-GET HTTP request, but also needs you to create your submit forms in a certain way. This is explained in the Security Library documentation.

#### Password handling ####
It is critical that you handle passwords in your application properly.

Unfortunately, many developers don’t know how to do that, and the web is full of outdated or otherwise wrongful advices, which doesn’t help.

We would like to give you a list of combined do’s and don’ts to help you with that. Please read below.

DO NOT store passwords in plain-text format.

Always hash your passwords.
DO NOT use Base64 or similar encoding for storing passwords.

This is as good as storing them in plain-text. Really. Do hashing, not encoding.

Encoding, and encryption too, are two-way processes. Passwords are secrets that must only be known to their owner, and thus must work only in one direction. Hashing does that - there’s no un-hashing or de-hashing, but there is decoding and decryption.
DO NOT use weak or broken hashing algorithms like MD5 or SHA1.

These algorithms are old, proven to be flawed, and not designed for password hashing in the first place.

Also, DON’T invent your own algorithms.

Only use strong password hashing algorithms like BCrypt, which is used in PHP’s own Password Hashing functions.

Please use them, even if you’re not running PHP 5.5+, O2System provides them for you as long as you’re running at least PHP version 5.3.7 (and if you don’t meet that requirement - please, upgrade).

If you’re one of the really unlucky people who can’t even upgrade to a more recent PHP version, use hash_pbkdf() <http://php.net/hash_pbkdf2>, which we also provide in our compatibility layer.
DO NOT ever display or send a password in plain-text format!

Even to the password’s owner, if you need a “Forgotten password” feature, just randomly generate a new, one-time (this is also important) password and send that instead.
DO NOT put unnecessary limits on your users’ passwords.

If you’re using a hashing algorithm other than BCrypt (which has a limit of 72 characters), you should set a relatively high limit on password lengths in order to mitigate DoS attacks - say, 1024 characters.

Other than that however, there’s no point in forcing a rule that a password can only be up to a number of characters, or that it can’t contain a certain set of special characters.

Not only does this reduce security instead of improving it, but there’s literally no reason to do it. No technical limitations and no (practical) storage constraints apply once you’ve hashed them, none!

#### Validate input data ####
O2System has a Form Library that assists you in validating, filtering, and prepping your data.

Even if that doesn’t work for your use case however, be sure to always validate and sanitize all input data. For example, if you expect a numeric string for an input variable, you can check for that with is_numeric() or ctype_digit(). Always try to narrow down your checks to a certain pattern.

Have it in mind that this includes not only $_POST and $_GET variables, but also cookies, the user-agent string and basically all data that is not created directly by your own code.

#### Escape all data before database insertion ####
Never insert information into your database without escaping it. Please see the section that discusses database queries for more information.

#### Hide your files ####
Another good security practice is to only leave your index.php and “assets” (e.g. .js, css and image files) under your server’s webroot directory (most commonly named “htdocs/”). These are the only files that you would need to be accessible from the web.

Allowing your visitors to see anything else would potentially allow them to access sensitive data, execute scripts, etc.

If you’re not allowed to do that, you can try using a .htaccess file to restrict access to those resources.

O2System will have an index.html file in all of its directories in an attempt to hide some of this data, but have it in mind that this is not enough to prevent a serious attacker.

### Coding Standards ###
The following page describes the coding styles adhered to when contributing to the development of O2System. There is no requirement to use these styles in your own O2System application, though they are recommended.

#### File Format ####
Files should be saved with Unicode (UTF-8) encoding. The BOM should not be used. Unlike UTF-16 and UTF-32, there’s no byte order to indicate in a UTF-8 encoded file, and the BOM can have a negative side effect in PHP of sending output, preventing the application from being able to set its own headers. Unix line endings should be used (LF).

Here is how to apply these settings in some of the more common text editors. Instructions for your text editor may vary; check your text editor’s documentation.

#### TextMate ####
Open the Application Preferences
Click Advanced, and then the “Saving” tab
In “File Encoding”, select “UTF-8 (recommended)”
In “Line Endings”, select “LF (recommended)”
> Optional: Check “Use for existing files as well” if you wish to modify the line endings of files you open to your new preference.

#### BBEdit ####
Open the Application Preferences
Select “Text Encodings” on the left.
In “Default text encoding for new documents”, select “Unicode (UTF-8, no BOM)”
Optional: In “If file’s encoding can’t be guessed, use”, select “Unicode (UTF-8, no BOM)”
Select “Text Files” on the left.
In “Default line breaks”, select “Mac OS X and Unix (LF)”

#### PHP Closing Tag ####
The PHP closing tag on a PHP document ?> is optional to the PHP parser. However, if used, any whitespace following the closing tag, whether introduced by the developer, user, or an FTP application, can cause unwanted output, PHP errors, or if the latter are suppressed, blank pages. For this reason, all PHP files MUST OMIT the PHP closing tag and end with a single empty line instead.

#### File Naming ####
Class files must be named in title case and use '_' as glue.

INCORRECT:
```php
XML.php
xml.php
XML_Parser.php
XML_PARSER.php
xmlParser.php
```

CORRECT:
```php
Xml.php
Xml_Parser.php
```

Furthermore the filepath must be placed based on namespace, please read [PSR-0 documentation](http://www.php-fig.org/psr/psr-0/)

#### Folder Naming ####
Folder must be named in lowercase.

INCORRECT:
```php
applications/CMS/core/
applications/modules/Wiki/
```

CORRECT:
```php
applications/cms/core/
applications/modules/wiki/
```

#### Class and Method Naming ####
Class names should always start with an uppercase letter. Multiple words should be separated with an underscore, and not CamelCased.

INCORRECT:
```php
class XML
{

}

class XML_Parser
{

}
```

CORRECT:
```php
class Xml 
{

}

class Xml_Parser 
{

}
```

Class methods should be entirely lowercased and named to clearly indicate their function, preferably including a verb. Try to avoid overly long and verbose names. Multiple words should be separated with an underscore.

INCORRECT:
```php
function mymethod(); // not descriptive and needs underscore separator
function myMethod(); // not descriptive and uses CamelCase
function MyMethod();  // uses CamelCase
function My_Method(); // don't use it
function My_method();
function MY_METHOD();
function this_is_my_method() // wordy
```

CORRECT:
```php
function my_method()  // descriptive, underscore separator, and all lowercase letters
```

#### Variable Names and Class Properties ####
The guidelines for variable naming are very similar to those used for class methods. Variables should contain only lowercase letters, use underscore separators, and be reasonably named to indicate their purpose and contents. Very short, non-word variables should only be used as iterators in for() loops.

INCORRECT:
```php
$j = 'foo';             // single letter variables should only be used in for() loops
$Str                    // contains uppercase letters
$bufferedText           // uses CamelCasing, and could be shortened without losing semantic meaning
$groupid                // multiple words, needs underscore separator
$name_of_last_city_used // too long
```

CORRECT:
```php
for ($j = 0; $j < 10; $j++)
$str
$buffer
$group_id
$last_city
```
#### Commenting ####
In general, code should be commented prolifically. It not only helps describe the flow and intent of the code for less experienced programmers, but can prove invaluable when returning to your own code months down the line. There is not a required format for comments, but the following are recommended.

DocBlock style comments preceding class, method, and property declarations so they can be picked up by IDEs:

```php
/**
 * Super Class
 *
 * @package     Package Name
 * @subpackage  Subpackage
 * @category    Category
 * @author      Author Name
 * @link        http://example.com
 */
class Super_class 
{
    /**
     * Encodes string for use in XML
     *
     * @param       string  $str    Input string
     * @return      string
     */
    public function my_method($str)
    {
    
    }
    
    /**
     * Data for class manipulation
     *
     * @var array
     */
    public $data = array();
}
```

Use single line comments within code, leaving a blank line between large comment blocks and code.

```php
// break up the string by newlines
$parts = explode("\n", $str);

// A longer comment that needs to give greater detail on what is
// occurring and why can use multiple single-line comments.  Try to
// keep the width reasonable, around 70 characters is the easiest to
// read.  Don't hesitate to link to permanent external resources
// that may provide greater detail:
//
// http://example.com/information_about_something/in_particular/

$parts = $this->foo($parts);
```

#### Constants ####
Constants follow the same guidelines as do variables, except constants should always be fully uppercase. Always use CodeIgniter constants when appropriate, i.e. SLASH, LD, RD, PATH_CACHE, etc.

INCORRECT:
```php
myConstant      // missing underscore separator and not fully uppercase
N               // no single-letter constants
S_C_VER         // not descriptive
$str = str_replace('{foo}', 'bar', $str);       // should use LD and RD constants
```

CORRECT:
```php
MY_CONSTANT
NEWLINE
SUPER_CLASS_VERSION
$str = str_replace(LD.'foo'.RD, 'bar', $str);
TRUE, FALSE, and NULL
TRUE, FALSE, and NULL keywords should always be fully uppercase.
```

INCORRECT:
```php
if ($foo == true)
$bar = false;
function foo($bar = null)
```

CORRECT:
```php
if ($foo == TRUE)
$bar = FALSE;
function foo($bar = NULL)
```
#### Logical Operators ####
Use of the || “or” comparison operator is discouraged, as its clarity on some output devices is low (looking like the number 11, for instance). && is preferred over AND but either are acceptable, and a space should always precede and follow !.

INCORRECT:
```php
if ($foo || $bar)
if ($foo AND $bar)  // okay but not recommended for common syntax highlighting applications
if (!$foo)
if (! is_array($foo))
```

CORRECT:
```php
if ($foo OR $bar)
if ($foo && $bar) // recommended
if ( ! $foo)
if ( ! is_array($foo))
```

#### Comparing Return Values and Typecasting ####
Some PHP functions return FALSE on failure, but may also have a valid return value of “” or 0, which would evaluate to FALSE in loose comparisons. Be explicit by comparing the variable type when using these return values in conditionals to ensure the return value is indeed what you expect, and not a value that has an equivalent loose-type evaluation.

Use the same stringency in returning and checking your own variables. Use === and !== as necessary.

INCORRECT:
```php
// If 'foo' is at the beginning of the string, strpos will return a 0,
// resulting in this conditional evaluating as TRUE
if (strpos($str, 'foo') == FALSE)
```

CORRECT:
```php
if (strpos($str, 'foo') === FALSE)
```

INCORRECT:
```php
function build_string($str = "")
{
    if ($str == "") // uh-oh!  What if FALSE or the integer 0 is passed as an argument?
    {

    }
}
```

CORRECT:
```php
function build_string($str = "")
{
    if ($str === "")
    {

    }
}
```
See also information regarding typecasting, which can be quite useful. Typecasting has a slightly different effect which may be desirable. When casting a variable as a string, for instance, NULL and boolean FALSE variables become empty strings, 0 (and other numbers) become strings of digits, and boolean TRUE becomes “1”:

```php
$str = (string) $str; // cast $str as a string
```

#### Debugging Code ####
Do not leave debugging code in your submissions, even when commented out. Things such as var_dump(), print_r(), die()/exit() should not be included in your code unless it serves a specific purpose other than debugging.

#### Whitespace in Files ####
No whitespace can precede the opening PHP tag or follow the closing PHP tag. Output is buffered, so whitespace in your files can cause output to begin before CodeIgniter outputs its content, leading to errors and an inability for O2System to send proper headers.

#### Compatibility ####
O2System recommends PHP 5.4 or newer to be used. Your code must either be compatible with this requirement, provide a suitable fallback, or be an optional feature that dies quietly without affecting a user’s application.

Additionally, do not use PHP functions that require non-default libraries to be installed unless your code contains an alternative method when the function is not available.

#### One File per Class ####
Use separate files for each class, unless the classes are closely related. An example of a O2System file that contains multiple classes is the CodeIgniter Xmlrpc library file.

#### Whitespace ####
Use tabs for whitespace in your code, not spaces. This may seem like a small thing, but using tabs instead of whitespace allows the developer looking at your code to have indentation at levels that they prefer and customize in whatever application they use. And as a side benefit, it results in (slightly) more compact files, storing one tab character versus, say, four space characters.

#### Line Breaks ####
Files must be saved with Unix line breaks. This is more of an issue for developers who work in Windows, but in any case ensure that your text editor is setup to save files with Unix line breaks.

#### Code Indenting ####
Use Allman style indenting. With the exception of Class declarations, braces are always placed on a line by themselves, and indented at the same level as the control statement that “owns” them.

INCORRECT:
```php
function foo($bar) {
    // ...
}

foreach ($arr as $key => $val) {
    // ...
}

if ($foo == $bar) {
     // ...
} else {
    // ...
}

for ($i = 0; $i < 10; $i++) {
    for ($j = 0; $j < 10; $j++) {
        // ...
    }
}

try {
    // ...
}
catch() {
    // ...
}
```

CORRECT:

```php
function foo($bar)
{
    // ...
}

foreach ($arr as $key => $val)
{
    // ...
}

if ($foo == $bar)
{
    // ...
}
else
{
    // ...
}

for ($i = 0; $i < 10; $i++)
{
    for ($j = 0; $j < 10; $j++)
    {
        // ...
    }
}

try
{
    // ...
}
catch()
{
    // ...
}
```

#### Bracket and Parenthetic Spacing ####
In general, parenthesis and brackets should not use any additional spaces. The exception is that a space should always follow PHP control structures that accept arguments with parenthesis (declare, do-while, elseif, for, foreach, if, switch, while), to help distinguish them from functions and increase readability.

INCORRECT:
```php
$arr[$foo] = 'foo'; // no spaces around array keys
$arr = array('android','blackberry'); // no spaces after comma
```

CORRECT:
```php
$arr[ $foo ] = 'foo';
$arr = array( 'android', 'blackberry' ); // use space after comma
```

INCORRECT:
```php
function foo($bar) // no spaces around parenthesis in function declarations
{

}
```

CORRECT:
```php
function foo( $bar ) // no spaces around parenthesis in function declarations
{

}
```

INCORRECT:
```php
foreach ($query->result() as $row) // single space following PHP control structures, but not in interior parenthesis
```

CORRECT:
```php
foreach( $query->result() as $row )
```

#### Localized Text ####
O2System libraries should take advantage of corresponding language files whenever possible.

INCORRECT:
```php
return "Invalid Selection";
```

CORRECT:

```php
return $this->lang->line('INVALID_SELECTION');
```

#### Private Methods and Variables ####
Methods and variables that are only accessed internally, such as utility and helper functions that your public methods use for code abstraction, should be prefixed with an underscore.

```php

// class properties declaration
public $version;
protected $_config;
private $__storage;

public static $version;
protected static $_instance;
private static $__reflection;

public function my_method() // none underscore prefix for public function
protected function _my_method() // use single underscore prefix for protected method function
protected function __my_method() // use double underscore prefix for private method
```

#### PHP Errors ####
Code must run error free and not rely on warnings and notices to be hidden to meet this requirement. For instance, never access a variable that you did not set yourself (such as $_POST array keys) without first checking to see that it isset().

Make sure that your dev environment has error reporting enabled for ALL users, and that display_errors is enabled in the PHP environment. You can check this setting with:

```php
if (ini_get('display_errors') == 1)
{
        exit "Enabled";
}
```

On some servers where display_errors is disabled, and you do not have the ability to change this in the php.ini, you can often enable it with:

```php
ini_set('display_errors', 1);
```

> **Note**
Setting the display_errors setting with ini_set() at runtime is not identical to having it enabled in the PHP environment. Namely, it will not have any effect if the script has fatal errors.
Short Open Tags
Always use full PHP opening tags, in case a server does not have short_open_tag enabled.

INCORRECT:
```php
<? echo $foo; ?>
<?=$foo?>
```
CORRECT:

```php
<?php echo $foo; ?>
```

> **Note**
PHP 5.4 will always have the <?= tag available.
One Statement Per Line
Never combine statements on one line.

INCORRECT:
```php
$foo = 'this'; $bar = 'that'; $bat = str_replace($foo, $bar, $bag);
```

CORRECT:
```php
$foo = 'this';
$bar = 'that';
$bat = str_replace($foo, $bar, $bag);
```

#### Strings ####
Always use single quoted strings unless you need variables parsed, and in cases where you do need variables parsed, use braces to prevent greedy token parsing. You may also use double-quoted strings if the string contains single quotes, so you do not have to use escape characters.

INCORRECT:
```php
"My String"                                     // no variable parsing, so no use for double quotes
"My string $foo"                                // needs braces
'SELECT foo FROM bar WHERE baz = \'bag\''       // ugly
```

CORRECT:
```php
'My String'
"My string {$foo}"
"SELECT foo FROM bar WHERE baz = 'bag'"
SQL Queries
SQL keywords are always capitalized: SELECT, INSERT, UPDATE, WHERE, AS, JOIN, ON, IN, etc.
```

Break up long queries into multiple lines for legibility, preferably breaking for each clause.

INCORRECT:

// keywords are lowercase and query is too long for
// a single line (... indicates continuation of line)
$query = $this->db->query("select foo, bar, baz, foofoo, foobar as raboof, foobaz from exp_pre_email_addresses
...where foo != 'oof' and baz != 'zab' order by foobaz limit 5, 100");
CORRECT:
```php
$query = $this->db->query("SELECT foo, bar, baz, foofoo, foobar AS raboof, foobaz
                                FROM exp_pre_email_addresses
                                WHERE foo != 'oof'
                                AND baz != 'zab'
                                ORDER BY foobaz
                                LIMIT 5, 100"
                          );
```

#### Default Function Arguments ####
Whenever appropriate, provide function argument defaults, which helps prevent PHP errors with mistaken calls and provides common fallback values which can save a few lines of code. Example:

```php
function foo($bar = '', $baz = FALSE)
```

### Reserved Names ###
In order to help out, CodeIgniter uses a series of function, method, class and variable names in its operation. Because of this, some names cannot be used by a developer. Following is a list of reserved names that cannot be used.

### Controller names ####
Since your controller classes will extend the main application controller you must be careful not to name your methods identically to the ones used by that class, otherwise your local methods will override them. The following is a list of reserved names. Do not name your controller any of these:

- O2System
- Default
- index

### Functions ###
- is_php()
- is_really_writable()
- load_class()
- is_loaded()
- get_config()
- config_item()
- show_error()
- show_404()
- log_message()
- set_status_header()
- get_mimes()
- html_escape()
- remove_invisible_characters()
- is_https()
- function_usable()
- \O2System::instance()
- _error_handler()
- _exception_handler()
- _stringify_attributes()
- Variables
- $config
- $db
- $lang
- Constants
- ENVIRONMENT
- FCPATH
- SELF
- BASEPATH
- APPPATH
- APPSPATH
- VIEWPATH
- SYSTEM_NAME
- SYSTEM_VERSION
- MB_ENABLED
- ICONV_ENABLED
- UTF8_ENABLED
- FILE_READ_MODE
- FILE_WRITE_MODE
- DIR_READ_MODE
- DIR_WRITE_MODE
- FOPEN_READ
- FOPEN_READ_WRITE
- FOPEN_WRITE_CREATE_DESTRUCTIVE
- FOPEN_READ_WRITE_CREATE_DESTRUCTIVE
- FOPEN_WRITE_CREATE
- FOPEN_READ_WRITE_CREATE
- FOPEN_WRITE_CREATE_STRICT
- FOPEN_READ_WRITE_CREATE_STRICT
- EXIT_SUCCESS
- EXIT_ERROR
- EXIT_CONFIG
- EXIT_UNKNOWN_FILE
- EXIT_UNKNOWN_CLASS
- EXIT_UNKNOWN_METHOD
- EXIT_USER_INPUT
- EXIT_DATABASE
- EXIT__AUTO_MIN
- EXIT__AUTO_MAX

### Upgrading from CodeIgniter ###
---------------------------------- 